import{gR as L}from"./index.8f6b05c6.js";function B(g,e,r){var C;const n=g.byteLength/(4*e),o=new Uint32Array(g,0,n*e);let f=new Uint32Array(n);const h=(C=r==null?void 0:r.minReduction)!=null?C:0,s=(r==null?void 0:r.originalIndices)||null,p=s?s.length:0,u=(r==null?void 0:r.componentOffsets)||null;let U=0;if(u)for(let t=0;t<u.length-1;t++){const i=u[t+1]-u[t];i>U&&(U=i)}else U=n;const w=Math.floor(1.1*U)+1;(a==null||a.length<2*w)&&(a=new Uint32Array(L(2*w)));for(let t=0;t<2*w;t++)a[t]=0;let c=0;const A=!!u&&!!s,b=A?p:n,m=A?new Uint32Array(p):null,M=1.96;let R=h!==0?Math.ceil(4*M*M/(h*h)*h*(1-h)):b,d=1,j=u?u[1]:b;for(let t=0;t<b;t++){if(t===R){const l=1-c/t;if(l+M*Math.sqrt(l*(1-l)/t)<h)return null;R*=2}if(t===j){for(let l=0;l<2*w;l++)a[l]=0;if(s)for(let l=u[d-1];l<u[d];l++)m[l]=f[s[l]];j=u[++d]}const i=A?s[t]:t,I=i*e,q=v(o,I,e);let y=q%w,k=c;for(;a[2*y+1]!==0;){if(a[2*y]===q){const l=a[2*y+1]-1;if(O(o,I,l*e,e)){k=f[l];break}}y++,y>=w&&(y-=w)}k===c&&(a[2*y]=q,a[2*y+1]=i+1,c++),f[i]=k}if(h!==0&&1-c/n<h)return null;if(A){for(let t=u[d-1];t<m.length;t++)m[t]=f[s[t]];f=m}const x=new Uint32Array(e*c);c=0;for(let t=0;t<b;t++)f[t]===c&&($(o,(A?s[t]:t)*e,x,c*e,e),c++);if(s&&!A){const t=new Uint32Array(p);for(let i=0;i<t.length;i++)t[i]=f[s[i]];f=t}return{buffer:x.buffer,indices:f,uniqueCount:c}}function O(g,e,r,n){for(let o=0;o<n;o++)if(g[e+o]!==g[r+o])return!1;return!0}function $(g,e,r,n,o){for(let f=0;f<o;f++)r[n+f]=g[e+f]}function v(g,e,r){let n=0;for(let o=0;o<r;o++)n=g[e+o]+n|0,n=n+(n<<11)+(n>>>2)|0;return n>>>0}let a=null;export{B as n};
